"0",""
"0","# ==============================================================================>"
"0","# Cluster scatter plot below"
"0","# (c). Recontruct Average net rent (left) and net rent per sqm (right) plus/minus one "
"0","# standard deviation versus area and year of construction"
"0","# ==============================================================================>"
"0",""
"0",""
"0","# Define function ---------------->"
"0","cluster_scatter <- function(data, x, y, title) {"
"0","  main <- data %>%"
"0","    group_by(.data[[x]]) %>%"
"0","    summarise("
"0","      y_mean = mean(.data[[y]], na.rm = TRUE),"
"0","      y_sd   = sd(.data[[y]], na.rm = TRUE),"
"0","      .groups = ""drop"""
"0","    ) %>%"
"0","    mutate("
"0","      ymin = y_mean - y_sd,"
"0","      ymax = y_mean + y_sd"
"0","    )"
"0","  "
"0","  ggplot(main, aes(x = .data[[x]], y = y_mean)) +"
"0","    geom_point(size = 1.5) +"
"0","    geom_errorbar(aes(ymin = ymin, ymax = ymax), width = 0.5) +"
"0","    labs("
"0","      title = title,"
"0","      x = x,"
"0","      y = paste(""Average"", y)"
"0","    ) +"
"0","    theme_minimal() +"
"0","    theme(plot.title = element_text(hjust = 0.5))"
"0","}"
"0",""
"0","p1 <- cluster_scatter(rent99, ""area"", ""rent"", ""Average net rent vs. area"")"
"0","p2 <- cluster_scatter(rent99, ""area"", ""rentsqm"", ""Average net rent per sqm vs. area"")"
"0","p3 <- cluster_scatter(rent99, ""yearc"", ""rent"", ""Average net rent vs. year of construction"")"
"0","p4 <- cluster_scatter(rent99, ""yearc"", ""rentsqm"", ""Average net rent per sqm vs. year of const."")"
"0",""
"0","grid.arrange(p1, p2, p3, p4, ncol = 2)"
