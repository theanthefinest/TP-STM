"0",""
"0","# H_{0} : p_{1} = p_{2} vs H_{a} : p_{1} != p_{2}"
"0","# Function for two proportion z-test"
"0","two_prop_test <- function(contingency_table) {"
"0","  # Extract values from contingency table"
"0","  n1 <- sum(contingency_table[""belted"", ])  # total belt users"
"0","  n2 <- sum(contingency_table[""none"", ])    # total non-users"
"0","  x1 <- contingency_table[""belted"", ""dead""] # deaths among belt users"
"0","  x2 <- contingency_table[""none"", ""dead""]   # deaths among non-users"
"0","  "
"0","  # Calculate proportions"
"0","  p1 <- x1 / n1"
"0","  p2 <- x2 / n2"
"0","  p_pool <- (x1 + x2) / (n1 + n2)"
"0","  "
"0","  # Calculate test statistic"
"0","  z_stat <- (p1 - p2) / sqrt(p_pool * (1 - p_pool) * (1/n1 + 1/n2))"
"0","  "
"0","  # Calculate two-sided p-value"
"0","  p_value <- 2 * (1 - pnorm(abs(z_stat)))"
"0","  "
"0","  # Return results"
"0","  return(list(test_statistic = z_stat, p_value = p_value))"
"0","}"
"0",""
"0","# Apply the function to our data"
"0","test_results <- two_prop_test(contingency_table)"
"0","cat(""\nTwo Proportion Z-Test Results:\n"")"
"1","
Two Proportion Z-Test Results:
"
"0","cat(""Test Statistic:"", test_results$test_statistic, ""\n"")"
"1","Test Statistic:"
"1"," "
"1","-22.02001"
"1"," "
"1","
"
"0","cat(""P-value:"", test_results$p_value, ""\n"")"
"1","P-value:"
"1"," "
"1","0"
"1"," "
"1","
"
"0","# Interpretation"
"0","if (test_results$p_value < 0.05) {"
"0","  cat(""Conclusion: Reject the null hypothesis - there is a significant difference in death proportions.\n"")"
"0","} else {"
"0","  cat(""Conclusion: Fail to reject the null hypothesis - no significant difference in death proportions.\n"")"
"0","}"
"1","Conclusion: Reject the null hypothesis - there is a significant difference in death proportions.
"
